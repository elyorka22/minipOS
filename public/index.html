<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#1a1a1a">
    <meta name="description" content="–£—á–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤ –≤ –ø—Ä–æ–¥—É–∫—Ç–æ–≤–æ–º –º–∞–≥–∞–∑–∏–Ω–µ">
    <title>–£—á–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="style.css">
    <!-- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —à—Ç—Ä–∏—Ö-–∫–æ–¥–æ–≤ -->
    <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
    <script>
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
        window.addEventListener('load', () => {
            if (typeof Html5Qrcode === 'undefined') {
                console.error('‚ùå –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ html5-qrcode –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞!');
                alert('–û—à–∏–±–∫–∞: –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Å–∫–∞–Ω–µ—Ä–∞ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.');
            } else {
                console.log('‚úÖ –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ html5-qrcode –∑–∞–≥—Ä—É–∂–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ');
            }
        });
    </script>
</head>
<body>
    <!-- –ü—Ä–æ–≤–µ—Ä–∫–∞ Telegram WebView -->
    <div id="telegram-warning" class="warning-screen hidden">
        <div class="warning-content">
            <h1>‚ö†Ô∏è</h1>
            <h2>–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ</h2>
            <p>–î–ª—è —Ä–∞–±–æ—Ç—ã –∫–∞–º–µ—Ä—ã –æ—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ Chrome</p>
            <button id="open-browser-btn" class="btn-primary">–û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ</button>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å -->
    <div id="main-app" class="hidden">
        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        <nav class="nav-buttons">
            <button id="btn-sale" class="nav-btn active" data-view="sale">
                <span class="btn-icon">üí∞</span>
                <span class="btn-text">–ü—Ä–æ–¥–∞–∂–∞</span>
            </button>
            <button id="btn-product-info" class="nav-btn" data-view="product-info">
                <span class="btn-icon">‚ÑπÔ∏è</span>
                <span class="btn-text">–û —Ç–æ–≤–∞—Ä–µ</span>
            </button>
            <button id="btn-warehouse" class="nav-btn" data-view="warehouse">
                <span class="btn-icon">üìã</span>
                <span class="btn-text">–°–∫–ª–∞–¥</span>
            </button>
            <button id="btn-history" class="nav-btn" data-view="history">
                <span class="btn-icon">üìä</span>
                <span class="btn-text">–ò—Å—Ç–æ—Ä–∏—è</span>
            </button>
        </nav>

        <!-- –≠–∫—Ä–∞–Ω –ø—Ä–æ–¥–∞–∂–∏ -->
        <div id="view-sale" class="view active">
            <div class="view-header">
                <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
                    <h1>–ü—Ä–æ–¥–∞–∂–∞ —Ç–æ–≤–∞—Ä–∞</h1>
                    <button id="btn-clear-cart" class="btn-secondary" style="display: none; padding: 0.5rem 1rem; font-size: 0.9rem;">–û—á–∏—Å—Ç–∏—Ç—å</button>
                </div>
            </div>
            <div id="scanner-container-sale" class="scanner-container">
                <div id="reader-sale"></div>
                <div class="scanner-overlay">
                    <div class="scanner-frame"></div>
                    <p class="scanner-hint">–ù–∞–≤–µ–¥–∏—Ç–µ –∫–∞–º–µ—Ä—É –Ω–∞ —à—Ç—Ä–∏—Ö-–∫–æ–¥</p>
                </div>
            </div>
            <div id="sale-add-product-prompt" class="add-product-prompt hidden">
                <p>–¢–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω</p>
                <p class="prompt-hint">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç—Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –µ—â–µ —Ä–∞–∑ –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ —Ç–æ–≤–∞—Ä –≤ —Å–∫–ª–∞–¥</p>
                <button id="btn-add-missing-product" class="btn-primary">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä –≤ —Å–∫–ª–∞–¥</button>
            </div>
            <div id="sale-cart" class="sale-cart">
                <div id="sale-cart-empty" class="cart-empty">
                    <p>–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞. –û—Ç—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ —Ç–æ–≤–∞—Ä—ã.</p>
                </div>
                <div id="sale-cart-items" class="cart-items hidden"></div>
                <div id="sale-cart-footer" class="cart-footer hidden">
                    <div class="cart-total">
                        <strong>–ò—Ç–æ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤: <span id="cart-total-count">0</span></strong>
                    </div>
                    <button id="btn-sell-all" class="btn-primary btn-large">–ü—Ä–æ–¥–∞—Ç—å –≤—Å–µ</button>
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–æ–≤–∞—Ä–µ -->
        <div id="view-product-info" class="view">
            <div class="view-header">
                <h1>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–≤–∞—Ä–µ</h1>
            </div>
            <div id="scanner-container-product-info" class="scanner-container">
                <div id="reader-product-info"></div>
                <div class="scanner-overlay">
                    <div class="scanner-frame"></div>
                    <p class="scanner-hint">–ù–∞–≤–µ–¥–∏—Ç–µ –∫–∞–º–µ—Ä—É –Ω–∞ —à—Ç—Ä–∏—Ö-–∫–æ–¥</p>
                </div>
            </div>
            <div id="product-info-panel" class="product-info-panel hidden">
                <div class="product-info-header">
                    <h2 id="product-info-name"></h2>
                    <div class="product-info-barcode">–®—Ç—Ä–∏—Ö-–∫–æ–¥: <span id="product-info-barcode"></span></div>
                </div>
                <div class="product-info-details">
                    <div class="info-item">
                        <span class="info-label">–û—Å—Ç–∞—Ç–æ–∫ –Ω–∞ —Å–∫–ª–∞–¥–µ:</span>
                        <span class="info-value" id="product-info-quantity"></span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">–¶–µ–Ω–∞:</span>
                        <span class="info-value" id="product-info-price"></span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">–î–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è:</span>
                        <span class="info-value" id="product-info-created"></span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:</span>
                        <span class="info-value" id="product-info-updated"></span>
                    </div>
                </div>
                <div class="product-info-actions">
                    <button id="btn-edit-from-info" class="btn-primary">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                    <button id="btn-receive-from-info" class="btn-secondary">–ü—Ä–∏–Ω—è—Ç—å —Ç–æ–≤–∞—Ä</button>
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω —Å–∫–ª–∞–¥–∞ -->
        <div id="view-warehouse" class="view">
            <div class="view-header">
                <h1>–°–∫–ª–∞–¥</h1>
                <div class="header-actions">
                    <button id="btn-receive-product" class="btn-secondary">üì¶ –ü—Ä–∏–Ω—è—Ç—å</button>
                    <button id="btn-add-product" class="btn-primary">+ –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
                </div>
            </div>
            <div class="search-container">
                <input type="text" id="warehouse-search" class="search-input" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏–ª–∏ —à—Ç—Ä–∏—Ö-–∫–æ–¥—É...">
            </div>
            <div id="warehouse-list" class="warehouse-list">
                <!-- –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ -->
        <div id="modal-add-product" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</h2>
                    <button id="modal-close" class="modal-close">√ó</button>
                </div>
                <form id="form-add-product">
                    <label>
                        –ù–∞–∑–≤–∞–Ω–∏–µ:
                        <input type="text" id="input-product-name" required class="input-field">
                    </label>
                    <label>
                        –®—Ç—Ä–∏—Ö-–∫–æ–¥:
                        <div class="barcode-input-group">
                            <input type="text" id="input-product-barcode" required class="input-field">
                            <button type="button" id="btn-scan-barcode" class="btn-secondary">–°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å</button>
                        </div>
                    </label>
                    <div id="scanner-container-add" class="scanner-container-small hidden">
                        <div id="reader-add"></div>
                        <button id="scanner-close" class="btn-secondary">–ó–∞–∫—Ä—ã—Ç—å —Å–∫–∞–Ω–µ—Ä</button>
                    </div>
                    <label>
                        –ù–∞—á–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ:
                        <input type="number" id="input-product-quantity" min="0" value="0" class="input-field">
                    </label>
                    <label>
                        –¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏ (‚ÇΩ):
                        <input type="number" id="input-product-price" min="0" step="0.01" value="0" class="input-field" placeholder="0.00">
                    </label>
                    <label>
                        –ó–∞–∫—É–ø–æ—á–Ω–∞—è —Ü–µ–Ω–∞ (‚ÇΩ):
                        <input type="number" id="input-product-purchase-price" min="0" step="0.01" value="0" class="input-field" placeholder="0.00">
                    </label>
                    <div class="modal-actions">
                        <button type="submit" class="btn-primary">–î–æ–±–∞–≤–∏—Ç—å</button>
                        <button type="button" id="form-cancel" class="btn-secondary">–û—Ç–º–µ–Ω–∞</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –∏—Å—Ç–æ—Ä–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–π -->
        <div id="view-history" class="view">
            <div class="view-header">
                <h1>–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π</h1>
            </div>
            <div class="search-container">
                <input type="text" id="history-search" class="search-input" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —Ç–æ–≤–∞—Ä–∞ –∏–ª–∏ —à—Ç—Ä–∏—Ö-–∫–æ–¥—É...">
            </div>
            <div id="history-list" class="history-list">
                <!-- –°–ø–∏—Å–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∏–µ–º–∞ —Ç–æ–≤–∞—Ä–∞ -->
        <div id="modal-receive-product" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>–ü—Ä–∏–Ω—è—Ç—å —Ç–æ–≤–∞—Ä</h2>
                    <button id="modal-receive-close" class="modal-close">√ó</button>
                </div>
                <div id="receive-scanner-container" class="scanner-container-small hidden">
                    <div id="reader-receive-modal"></div>
                    <button id="scanner-receive-close" class="btn-secondary">–ó–∞–∫—Ä—ã—Ç—å —Å–∫–∞–Ω–µ—Ä</button>
                </div>
                <div id="receive-product-info" class="receive-product-info">
                    <h3 id="receive-product-name">–û—Ç—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ —à—Ç—Ä–∏—Ö-–∫–æ–¥ —Ç–æ–≤–∞—Ä–∞</h3>
                    <div class="receive-product-barcode">–®—Ç—Ä–∏—Ö-–∫–æ–¥: <span id="receive-product-barcode">-</span></div>
                    <div class="receive-product-stock">–¢–µ–∫—É—â–∏–π –æ—Å—Ç–∞—Ç–æ–∫: <span id="receive-product-stock">-</span></div>
                    <button id="btn-scan-receive" class="btn-secondary" style="margin-top: 0.5rem;">–°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —à—Ç—Ä–∏—Ö-–∫–æ–¥</button>
                </div>
                <form id="form-receive-product">
                    <input type="hidden" id="receive-product-id">
                    <label>
                        –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–ª—è –ø—Ä–∏–µ–º–∞:
                        <input type="number" id="receive-product-quantity" min="1" value="1" class="input-field" required>
                    </label>
                    <div class="modal-actions">
                        <button type="submit" class="btn-primary" id="btn-submit-receive" disabled>–ü—Ä–∏–Ω—è—Ç—å —Ç–æ–≤–∞—Ä</button>
                        <button type="button" id="form-receive-cancel" class="btn-secondary">–û—Ç–º–µ–Ω–∞</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ -->
        <div id="modal-edit-product" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä</h2>
                    <button id="modal-edit-close" class="modal-close">√ó</button>
                </div>
                <form id="form-edit-product">
                    <input type="hidden" id="edit-product-id">
                    <label>
                        –ù–∞–∑–≤–∞–Ω–∏–µ:
                        <input type="text" id="edit-product-name" required class="input-field">
                    </label>
                    <label>
                        –®—Ç—Ä–∏—Ö-–∫–æ–¥:
                        <input type="text" id="edit-product-barcode" required class="input-field">
                    </label>
                    <label>
                        –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:
                        <input type="number" id="edit-product-quantity" min="0" value="0" class="input-field">
                    </label>
                    <label>
                        –¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏ (‚ÇΩ):
                        <input type="number" id="edit-product-price" min="0" step="0.01" value="0" class="input-field" placeholder="0.00">
                    </label>
                    <label>
                        –ó–∞–∫—É–ø–æ—á–Ω–∞—è —Ü–µ–Ω–∞ (‚ÇΩ):
                        <input type="number" id="edit-product-purchase-price" min="0" step="0.01" value="0" class="input-field" placeholder="0.00">
                    </label>
                    <div class="modal-actions">
                        <button type="submit" class="btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                        <button type="button" id="form-edit-cancel" class="btn-secondary">–û—Ç–º–µ–Ω–∞</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
        <div id="notification" class="notification hidden"></div>
    </div>

    <script src="app.js"></script>
</body>
</html>

